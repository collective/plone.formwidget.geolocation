"use strict";(self.webpackChunkplone_formwidget_geolocation=self.webpackChunkplone_formwidget_geolocation||[]).push([[27],{7027:(e,t,r)=>{var n=r(2511),o=r.n(n),i=r(8633);const a=new Map,s=(e,t)=>{const r=e?[e]:a.keys();for(const e of r){if(!e?.removeEventListener)return;const r=a.get(e);if(!r)return;let n;n=t?[...r.entries()].filter((e=>i.A.regexp_from_wildcard(t).test(e[0]))):r.entries();for(const t of n||[])e.removeEventListener(t[1][0],t[1][1],t[1][2]),a.get(e).delete(t[0]),a.get(e).size||a.delete(e)}},l=(e,t,r,n,o={})=>{if(!e?.addEventListener)return;s(e,r),a.has(e)||a.set(e,new Map);let i=n;!0===o?.once&&(i=t=>{a.get(e)?.delete(r),n(t)}),a.get(e).set(r,[t,i,o.capture?o:void 0]),e.addEventListener(t,i,o)};var d=r(3505);const u=d.A.getLogger("basepattern");class c{static name;static trigger;static parser;parser_group_options=!0;parser_multiple=void 0;parser_inherit=!0;constructor(e,t={}){this.name=this.constructor.name,this.trigger=this.constructor.trigger,this.parser=this.constructor.parser,e?(e.jquery&&(e=e[0]),this.el=e,this.el.dispatchEvent(new Event(`pre-init.${this.name}.patterns`,{bubbles:!0,cancelable:!0})),window.setTimeout((async()=>{if(void 0!==this.el[`pattern-${this.name}`])return u.debug(`Not reinstatiating the pattern ${this.name}.`,this.el),void this.el.dispatchEvent(new Event(`not-init.${this.name}.patterns`,{bubbles:!0,cancelable:!1}));this.options=this.parser?.parse(this.el,t,this.parser_multiple,this.parser_inherit,this.parser_group_options)??t,this.el[`pattern-${this.name}`]=this,await this.init(),this.el.dispatchEvent(new Event(`init.${this.name}.patterns`,{bubbles:!0,cancelable:!0}))}),0)):u.warn(`No element given to pattern ${this.name}.`)}async init(){}one(e,t){l(this.el,`${e}.${this.name}.patterns`,`basepattern-one--${e}.${this.name}.patterns`,t,{once:!0})}destroy(){delete this.el[`pattern-${this.name}`]}}class p{constructor(e){this.order=[],this.parameters={},this.attribute="data-pat-"+e,this.enum_values={},this.enum_conflicts=[],this.groups={},this.possible_groups={},this.log=d.A.getLogger(e+".parser"),this.group_pattern=/([a-z][a-z0-9]*)-([A-Z][a-z0-0\-]*)/i,this.json_param_pattern=/^\s*\[?\s*{/i,this.named_param_pattern=/^\s*([a-z][a-z0-9\-]*)\s*:(.*)/is,this.token_pattern=/((["']).*?(?!\\)\2)|\s*(\S+)\s*/g}_camelCase(e){return e.replace(/\-([a-z])/g,((e,t)=>t.toUpperCase()))}addAlias(e,t){if(!this.parameters[t])throw`Attempted to add an alias "${e}" for a non-existing parser argument "${t}".`;this.parameters[t].alias=e}addGroupToSpec(e){const t=e.name.match(this.group_pattern);if(t){const r=t[1],n=t[2];if(r in this.possible_groups){const e=this.possible_groups[r],t=e.name.match(this.group_pattern)[2];e.group=r,e.dest=t,this.groups[r]=new p,this.groups[r].addArgument(t,e.value,e.choices,e.multiple),delete this.possible_groups[r]}r in this.groups?(this.groups[r].addArgument(n,e.value,e.choices,e.multiple),e.group=r,e.dest=n):(this.possible_groups[r]=e,e.dest=this._camelCase(e.name))}return e}addJSONArgument(e,t){this.order.push(e),this.parameters[e]=this.addGroupToSpec({name:e,value:t,dest:e,group:null,type:"json"})}addArgument(e,t,r,n){const o={name:e,value:n&&!Array.isArray(t)?[t]:t,multiple:n,dest:e,group:null};if(r&&Array.isArray(r)&&r.length){o.choices=r,o.type=this._typeof(r[0]);for(const t of r)-1===this.enum_conflicts.indexOf(t)&&(t in this.enum_values?(this.enum_conflicts.push(t),delete this.enum_values[t]):this.enum_values[t]=e)}else"string"==typeof o.value&&"$"===o.value.slice(0,1)?o.type=this.parameters[o.value.slice(1)].type:o.type=this._typeof(n?o.value[0]:o.value);this.order.push(e),this.parameters[e]=this.addGroupToSpec(o)}_typeof(e){return null===e?"null":typeof e}_coerce(e,t){const r=this.parameters[e];if(typeof t!==r.type)try{switch(r.type){case"json":t=JSON.parse(t);break;case"boolean":if("string"==typeof t){t=t.toLowerCase();const e=parseInt(t,10);t=isNaN(e)?"true"===t||"y"===t||"yes"===t||"y"===t||"on"===t:!!e}else{if("number"!=typeof t)throw`Cannot convert value for ${e} to boolean.`;t=!!t}break;case"number":if("string"==typeof t){if(t=parseInt(t,10),isNaN(t))throw`Cannot convert value for ${e} to number.`}else{if("boolean"!=typeof t)throw`Cannot convert value for ${e} to number.`;t+=0}break;case"string":t=t.toString();break;case"null":case"undefined":break;default:throw`Do not know how to convert value for ${e} of type ${typeof t} to ${r.type}.`}}catch(e){return this.log.warn(e),null}return r.choices&&-1===r.choices.indexOf(t)?(this.log.warn(`Illegal value for ${e}: ${t}.`),null):t}_set(e,t,r){if(!(t in this.parameters))return void this.log.debug(`Ignoring value for unknown argument: ${t}.`);let n;if(this.parameters[t].multiple){n="string"==typeof r?r.split(/,+/):r,r=[];for(const e of n){const n=this._coerce(t,e.trim());null!==n&&r.push(n)}}else if(null===(r=this._coerce(t,r)))return;e[t]=r}_split(e){const t=[];return e.replace(this.token_pattern,((e,r,n,o)=>{r?t.push(r):o&&t.push(o)})),t}_parseExtendedNotation(e){const t={},r=e.replace(/;;/g,"\0x1f").replace(/&amp;/g,"&amp\0x1f").split(/;/).map((e=>e.replace(new RegExp("\0x1f","g"),";")));for(const n of r){if(!n)continue;const r=n.match(this.named_param_pattern);if(!r){this.log.warn(`Invalid parameter: ${n}: ${e}.`);continue}const o=r[1],i=r[2].trim(),a=Object.values(this.parameters).filter((e=>e.alias===o));if(1===a.length)this._set(t,a[0].name,i);else if(o in this.parameters)this._set(t,o,i);else{if(!(o in this.groups)){this.log.warn(`Unknown named parameter: ${r[1]}.`);continue}{const e=this.groups[o]._parseShorthandNotation(i);for(const r in e)this._set(t,o+"-"+r,e[r])}}}return t}_parseShorthandNotation(e){const t=this._split(e),r={};let n=0;for(;t.length;){const e=t.shift().trim();let o,i,a=!0;if("no-"===e.slice(0,3)?(o=!1,i=e.slice(3)):(o=!0,i=e),i in this.parameters&&"boolean"===this.parameters[i].type)a=!1,this._set(r,i,o);else if(i in this.enum_values)a=!1,this._set(r,this.enum_values[i],i);else{if(!a){t.unshift(e);break}this._set(r,this.order[n],e)}if(n++,n>=this.order.length)break}return t.length&&this.log.warn(`Ignore extra arguments: ${t.join(" ")}.`),r}_parse(e){if(!e)return{};if(e.match(this.json_param_pattern))try{return JSON.parse(e)}catch(t){this.log.warn(`Invalid JSON argument found: ${e}.`)}if(e.match(this.named_param_pattern))return this._parseExtendedNotation(e);const t=e.indexOf(";");if(-1===t)return this._parseShorthandNotation(e);const r=this._parseShorthandNotation(e.slice(0,t)),n=this._parseExtendedNotation(e.slice(t+1));for(const e in n)r[e]=n[e];return r}_defaults(e){const t={};for(const r in this.parameters)if("function"==typeof this.parameters[r].value)try{t[r]=this.parameters[r].value(e,r),this.parameters[r].type=typeof t[r]}catch(e){this.log.error(`Default function for ${r} failed.`)}else t[r]=this.parameters[r].value;return t}_cleanupOptions(e,t=!0){for(const t of Object.keys(e)){const r=this.parameters[t];void 0!==r&&(e[t]===r.value&&"string"==typeof r.value&&"$"===r.value.slice(0,1)&&(e[t]=e[r.value.slice(1)]))}if(t)for(const t of Object.keys(e)){const r=this.parameters[t];let n;void 0!==r&&(r.group?("object"!=typeof e[r.group]&&(e[r.group]={}),n=e[r.group]):n=e,r.dest!==t&&(n[r.dest]=e[t],delete e[t]))}return e}parse(e,t,r,n=!0,a=!0){e.jquery||(e=o()(e)),"boolean"==typeof t&&void 0===r&&(r=t,t={});const s=n?[[this._defaults(e)]]:[[{}]];let l,d=1;l=!n||e.hasClass("pat-modal")&&"data-pat-inject"===this.attribute?e:e.parents(`[${this.attribute}]`).addBack();for(const e of l){let t;const r=(o()(e).attr(this.attribute)||"").trim();if(!r)continue;const n=this._parse.bind(this);t=r.match(/&&/)?r.split(/\s*&&\s*/).map(n):n(r),Array.isArray(t)||(t=[t]),d=Math.max(t.length,d),s.push(t)}"object"==typeof t&&(Array.isArray(t)?(s.push(t),d=Math.max(t.length,d)):s.push([t])),r||(d=1);const u=i.A.removeDuplicateObjects(i.A.mergeStack(s,d)).map((e=>this._cleanupOptions(e,a)));return r?u:u[0]}}p.prototype.add_argument=p.prototype.addArgument;const h=p;var f=r(9329);const m=d.A.getLogger("pat-leaflet");m.debug("pattern loaded");const g=new h("leaflet");g.addArgument("latitude","0.0"),g.addArgument("longitude","0.0"),g.addArgument("zoom","auto"),g.addArgument("maxClusterRadius","80"),g.addArgument("useCluster",!0),g.addArgument("boundsPadding","20"),g.addArgument("fullscreencontrol",!0),g.addArgument("zoomcontrol",!0),g.addArgument("addmarker",!1),g.addArgument("autolocate",!1),g.addArgument("geosearch",!1),g.addArgument("geosearch_provider","openstreetmap"),g.addArgument("locatecontrol",!1),g.addArgument("minimap",!1),g.addArgument("default_map_layer",{id:"OpenStreetMap.Mapnik",options:{}}),g.addArgument("map_layers",[{title:"Map",id:"OpenStreetMap.Mapnik",options:{}},{title:"Satellite",id:"Esri.WorldImagery",options:{}},{title:"Topographic",id:"OpenTopoMap",options:{}}]),g.addArgument("image_path","node_modules/leaflet.awesome-markers/dist/images"),g.addArgument("geojson_ajaxurl","");class _ extends c{static name="leaflet";static trigger=".pat-leaflet";static parser=g;map=null;async init(){Promise.all([r.e(78),r.e(433)]).then(r.bind(r,4078)),this.L=(await r.e(481).then(r.t.bind(r,3481,23))).default;const e=(await r.e(389).then(r.t.bind(r,9389,23))).MarkerClusterGroup;await Promise.all([r.e(481),r.e(235)]).then(r.t.bind(r,3235,23)),await r.e(204).then(r.t.bind(r,3204,23)),await r.e(268).then(r.t.bind(r,4268,23)),await Promise.all([r.e(481),r.e(401)]).then(r.t.bind(r,9401,23));const t=this.options,n=this.fitBoundsOptions={maxZoom:t.zoom,padding:[parseInt(t.boundsPadding),parseInt(t.boundsPadding)]};this.main_marker=null;const i=this.map=this.L.map(this.el,{fullscreenControl:t.fullscreencontrol,zoomControl:t.zoomcontrol,sleep:!0,sleepNote:!1,hoverToWake:!1,sleepOpacity:1});if(1==t.useCluster?this.marker_cluster=new e({maxClusterRadius:this.options.maxClusterRadius}):this.marker_cluster=new this.L.featureGroup,i.on("moveend zoomend",(e=>{o()(this.el).trigger(`leaflet.${e.type}`,{original_event:e})})),this.L.Icon.Default.imagePath=t.image_path,t.locatecontrol||t.autolocate){await Promise.all([r.e(481),r.e(245)]).then(r.t.bind(r,245,23));const e=this.L.control.locate().addTo(i);t.autolocate&&e.start()}if(Array.isArray(t.map_layers)){const e={};t.map_layers=t.map_layers.map((function(e){return"string"==typeof e&&(e={id:e,title:e,options:{}}),e}));for(const r of t.map_layers)e[r.title]=this.L.tileLayer.provider(r.id,r.options);t.map_layers.length>1&&this.L.control.layers(e).addTo(i)}if("string"==typeof t.default_map_layer&&(t.default_map_layer={id:t.default_map_layer,options:{}}),this.L.tileLayer.provider(t.default_map_layer.id,t.default_map_layer.options).addTo(i),"auto"===t.zoom?i.setView([t.latitude,t.longitude],14):i.setView([t.latitude,t.longitude],t.zoom),""!==t.geojson_ajaxurl){let e;try{e=await fetch(t.geojson_ajaxurl);const r=await e.json();this.init_geojson(i,r)}catch(e){return void m.info(`Could not load geojson data from url ${t.geojson_ajaxurl}`)}}else if(this.el.dataset.geojson)try{this.init_geojson(i,JSON.parse(this.el.dataset.geojson))}catch(e){return void m.info("Could not parse geojson data.")}if(t.geosearch){const{GeoSearchControl:e}=await Promise.all([r.e(481),r.e(294)]).then(r.bind(r,8294));let o;o="esri"===t.geosearch_provider?(await Promise.all([r.e(481),r.e(294)]).then(r.bind(r,8294))).EsriProvider:"google"===t.geosearch_provider?(await Promise.all([r.e(481),r.e(294)]).then(r.bind(r,8294))).GoogleProvider:"bing"===t.geosearch_provider?(await Promise.all([r.e(481),r.e(294)]).then(r.bind(r,8294))).BingProvider:(await Promise.all([r.e(481),r.e(294)]).then(r.bind(r,8294))).OpenStreetMapProvider;const a=new e({showMarker:null===this.main_marker,provider:new o});i.addControl(a),i.on("geosearch/showlocation",(e=>{const t={lat:e.location.y,lng:e.location.x};this.main_marker&&this.main_marker.feature.properties.editable?(this.marker_cluster.removeLayer(this.main_marker),this.main_marker.setLatLng(t).update(),this.marker_cluster.addLayer(this.main_marker)):(e.marker.setIcon(this.create_marker("red")),this.bind_popup({properties:{editable:!0,popup:e.location.label}},e.marker),this.marker_cluster.addLayer(e.marker)),i.fitBounds([t],n)}))}if(t.addmarker){await r.e(859).then(r.t.bind(r,1859,23));const e=function(e){this.bind_popup({properties:{editable:!0}},e)},t=new this.L.Control.SimpleMarkers({delete_control:!1,allow_popup:!1,marker_icon:this.create_marker("red"),marker_draggable:!0,add_marker_callback:e.bind(this)});i.addControl(t)}if(t.minimap){await Promise.all([r.e(481),r.e(395)]).then(r.t.bind(r,4395,23));const e=new this.L.Control.MiniMap(this.L.tileLayer.provider(t.default_map_layer.id,t.default_map_layer.options),{toggleDisplay:!0,mapOptions:{sleep:!1}});i.addControl(e)}m.debug("pattern initialized")}init_geojson(e,t){let r;const n=this.L.geoJson(t,{pointToLayer:(t,n)=>{const o=t.properties.extraClasses||"";let i="green";t.properties.color?i=t.properties.color:this.main_marker&&!t.properties.main||(i="red");const a=this.create_marker(i,o),s=new this.L.Marker(n,{icon:a,draggable:t.properties.editable});this.main_marker&&!t.properties.main||(this.main_marker=s);const d=document.querySelector(t.properties.latinput),u=document.querySelector(t.properties.lnginput);return s.on("dragend move",(e=>{const t=e.target.getLatLng();d&&(d.value=t.lat),u&&(u.value=t.lng)})),d&&l(d,"input","pat-leaflet--input_lat",(t=>{const n=s.getLatLng();this.marker_cluster.removeLayer(s),s.setLatLng({lat:t.target.value,lng:n.lng}).update(),this.marker_cluster.addLayer(s),r=this.marker_cluster.getBounds(),e.fitBounds(r,this.fitBoundsOptions)})),u&&l(u,"input","pat-leaflet--input_lng",(t=>{const n=s.getLatLng();this.marker_cluster.removeLayer(s),s.setLatLng({lat:n.lat,lng:t.target.value}).update(),this.marker_cluster.addLayer(s),r=this.marker_cluster.getBounds(),e.fitBounds(r,this.fitBoundsOptions)})),s},onEachFeature:this.bind_popup.bind(this)});this.marker_cluster.addLayer(n),e.addLayer(this.marker_cluster),"auto"===this.options.zoom&&(r=this.marker_cluster.getBounds(),e.fitBounds(r,this.fitBoundsOptions))}bind_popup(e,t){const r=e.properties.popup||"";if(e.properties.editable&&!e.properties.no_delete){const e=document.createElement("div");e.innerHTML=`\n              <div>${r}</div>\n              <br/>\n              <button type="button" class="delete-marker">Delete marker</button>\n            `,e.querySelector(".delete-marker").addEventListener("click",(e=>{e.preventDefault(),this.map.removeLayer(t),t=void 0})),t.bindPopup(e)}else r&&t.bindPopup(r)}create_marker(e,t){return e=e||"red",t=t||"",this.L.AwesomeMarkers.icon({markerColor:e,prefix:"fa",icon:"circle",extraClasses:t})}}f.A.register(_)},2800:(e,t,r)=>{r.d(t,{A:()=>c});const n=r(3505).A.getLogger("core dom"),o="__patternslib__data_prefix__",i="__patternslib__style__display";function a(e,t,r=!1,n=!1){let o=window.getComputedStyle(e).getPropertyValue(t);return(r||n)&&(o=parseFloat(o)||0),r&&!n&&(o=parseInt(Math.round(o),10)),o}const s=(e,t=document.body)=>{t===window&&(t=document.body);const r=Math.abs(e.getBoundingClientRect().left+t.scrollLeft-t.getBoundingClientRect().left-u.get_css_value(t,"border-left-width",!0));return{top:Math.abs(e.getBoundingClientRect().top+t.scrollTop-t.getBoundingClientRect().top-u.get_css_value(t,"border-top-width",!0)),left:r}},l=(e,t,r)=>e[`${o}${t}`]||r,d=(e,t,r)=>{e[`${o}${t}`]=r},u={toNodeArray:e=>(e.jquery||e instanceof NodeList?e=[...e]:e instanceof Array==!1&&(e=[e]),e),querySelectorAllAndMe:(e,t)=>{if(!e)return[];const r=[...e.querySelectorAll(t)];return e.matches(t)&&r.unshift(e),r},wrap:(e,t)=>{e.parentNode.insertBefore(t,e),t.appendChild(e)},hide:e=>{"none"!==e.style.display&&(e.style.display&&(e[i]=e.style.display),e.style.display="none")},show:e=>{const t=e[i]||null;e.style.display=t,delete e[i]},find_parents:(e,t)=>{const r=[];let n=e;for(;n;)n=n.parentNode?.closest?.(t),n&&r.push(n);return r},find_scoped:(e,t)=>(0===t.indexOf("#")?document:e).querySelectorAll(t),get_parents:e=>{const t=[];let r=e?.parentNode;for(;r;)t.push(r),r=r?.parentNode,r=r instanceof HTMLElement?r:null;return t},acquire_attribute:(e,t,r=!1,n=!1)=>{let o=e;const i=[];for(;o;){const e=o.getAttribute(t);if(e||r&&""===e){if(!n)return e;i.push(e)}o=o.parentElement}if(n)return i},is_visible:e=>e.offsetWidth>0&&e.offsetHeight>0,is_input:e=>/^(?:input|select|textarea|button)$/i.test(e.nodeName),create_from_string:e=>document.createRange().createContextualFragment(e.trim()),get_css_value:a,find_scroll_container:(e,t,r=document.body)=>{for(;e&&e!==document.body;){if(!t||"y"===t){let t=a(e,"overflow-y");if(["auto","scroll"].includes(t))return e}if(!t||"x"===t){let t=a(e,"overflow-x");if(["auto","scroll"].includes(t))return e}e=e.parentElement}return r},get_scroll_x:e=>void 0!==e.scrollLeft?e.scrollLeft:e.scrollX,get_scroll_y:e=>void 0!==e.scrollTop?e.scrollTop:e.scrollY,get_relative_position:s,scroll_to_element:(e,t,r=0,n="top")=>{const o=s(e,t),i={behavior:"auto"};"top"!==n&&"both"!==n||(i.top=o.top-r),"left"!==n&&"both"!==n||(i.left=o.left-r),t.scrollTo(i)},scroll_to_top:(e=document.body,t=0)=>{e.scrollTo({top:0-t,behavior:"auto"})},scroll_to_bottom:(e=document.body,t=0)=>{const r=(e===window?document.body:e).scrollHeight;e.scrollTo({top:r-t,behavior:"auto"})},get_data:l,set_data:d,delete_data:(e,t)=>{delete e[`${o}${t}`]},template:(e,t={})=>(n.warn("Using dom.template is not recommended due to a problem with Content-Security-Policy."),new Function("return `"+e+"`;").call(t)),get_visible_ratio:(e,t)=>{if(!e)return 0;const r=e.getBoundingClientRect(),n=t!==window?t.getBoundingClientRect():{top:0,bottom:window.innerHeight};let o=0;if(r.top<n.bottom&&r.bottom>n.top){const e=r.bottom-r.top;o=(Math.min(r.bottom,n.bottom)-Math.max(r.top,n.top))/e}return o},escape_css_id:e=>`#${CSS.escape(e.split("#")[1])}`,element_uuid:e=>{if(!l(e,"uuid",!1)){let t;if(window.crypto.randomUUID)t=window.crypto.randomUUID();else{const e=new Uint32Array(4);t=window.crypto.getRandomValues(e).join("")}d(e,"uuid",t)}return l(e,"uuid")},find_form:e=>e.closest(".pat-subform")||e.form||e.querySelector("input, select, textarea, button")?.form||e.closest("form")},c=u},3505:(e,t,r)=>{var n,o;r.d(t,{A:()=>c}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),r=this,n=function(){},o=function(){return r.apply(this instanceof n&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o});var i={DEBUG:10,INFO:20,WARN:30,ERROR:40,FATAL:50};function a(){}function s(e,t){this._loggers={},this.name=e||"",this._parent=t||null,t||(this._enabled=!0,this._level=i.WARN)}function l(e){o=e}a.prototype={output:function(e,t,r){e&&r.unshift(e+":"),t<=i.DEBUG?(r.unshift("[DEBUG]"),console.log.apply(console,r)):t<=i.INFO?console.info.apply(console,r):t<=i.WARN?console.warn.apply(console,r):console.error.apply(console,r)}},s.prototype={getLogger:function(e){for(var t=e.split("."),r=this,n=this.name?[this.name]:[];t.length;){var o=t.shift();n.push(o),o in r._loggers||(r._loggers[o]=new s(n.join("."),r)),r=r._loggers[o]}return r},_getFlag:function(e){var t=this;for(e="_"+e;null!==t;){if(void 0!==t[e])return t[e];t=t._parent}return null},setEnabled:function(e){this._enabled=!!e},isEnabled:function(){this._getFlag("enabled")},setLevel:function(e){"number"==typeof e?this._level=e:"string"==typeof e&&(e=e.toUpperCase())in i&&(this._level=i[e])},getLevel:function(){return this._getFlag("level")},log:function(e,t){!t.length||!this._getFlag("enabled")||e<this._getFlag("level")||(t=Array.prototype.slice.call(t),o.output(this.name,e,t))},debug:function(){this.log(i.DEBUG,arguments)},info:function(){this.log(i.INFO,arguments)},warn:function(){this.log(i.WARN,arguments)},error:function(){this.log(i.ERROR,arguments)},fatal:function(){this.log(i.FATAL,arguments)}},l(new a),n=new s;for(var d,u=/loglevel(|-[^=]+)=([^&]+)/g;null!==(d=u.exec(window.location.search));){(""===d[1]?n:n.getLogger(d[1].slice(1))).setLevel(d[2].toUpperCase())}const c={Level:i,getLogger:n.getLogger.bind(n),setEnabled:n.setEnabled.bind(n),isEnabled:n.isEnabled.bind(n),setLevel:n.setLevel.bind(n),getLevel:n.getLevel.bind(n),debug:n.debug.bind(n),info:n.info.bind(n),warn:n.warn.bind(n),error:n.error.bind(n),fatal:n.fatal.bind(n),getWriter:function(){return o},setWriter:l}},9329:(e,t,r)=>{r.d(t,{A:()=>g});var n=r(2511),o=r.n(n),i=r(2800),a=r(3505),s=r(8633);const l=a.A.getLogger("registry"),d=/patterns-disable=([^&]+)/g,u=/patterns-dont-catch/g,c={};let p,h=!1;for(;null!==(p=d.exec(window.location.search));)c[p[1]]=!0,l.info("Pattern disabled via url config:",p[1]);for(;null!==(p=u.exec(window.location.search));)h=!0,l.info("I will not catch init exceptions");void 0===window.__patternslib_registry&&(window.__patternslib_registry={});const f=window.__patternslib_registry;void 0===window.__patternslib_registry_initialized&&(window.__patternslib_registry_initialized=!1);const m={patterns:f,init(){o()(document).ready((function(){window.__patternslib_registry_initialized||(window.__patternslib_registry_initialized=!0,l.debug("Loaded: "+Object.keys(m.patterns).sort().join(", ")),m.scan(document.body),l.debug("Finished initial scan."))}))},clear(){for(const e in m.patterns)delete m.patterns[e]},transformPattern(e,t){if(c[e])return void l.debug(`Skipping disabled pattern: ${e}.`);const r=m.patterns[e],n=r.transform||r.prototype?.transform;if(n)try{n(o()(t))}catch(t){if(h)throw t;l.error(`Transform error for pattern ${e}.`,t)}},initPattern(e,t,r){const n=o()(t),i=m.patterns[e],s=a.A.getLogger(`pat.${e}`);if(t.matches(i.trigger)){s.debug("Initialising.",t);try{i.init?i.init(n,null,r):new i(n,null,r),s.debug("done.")}catch(e){if(h)throw e;s.error("Caught error:",e)}}},orderPatterns:e=>(e.includes("validation")&&(e.splice(e.indexOf("validation"),1),e.unshift("validation")),e.includes("clone-code")&&(e.splice(e.indexOf("clone-code"),1),e.unshift("clone-code")),e),scan(e,t,r){if(!e)return;if("string"==typeof e)e=document.querySelector(e);else{if(e instanceof Text)return;e.jquery&&(e=e[0])}const n=[];t=this.orderPatterns(t||Object.keys(m.patterns));for(const r of t){this.transformPattern(r,e);const t=m.patterns[r];t.trigger&&n.unshift(t.trigger)}let o=i.A.querySelectorAllAndMe(e,n.map((e=>e.trim().replace(/,$/,""))).join(","));o=o.filter((e=>!(e.matches(".disable-patterns")||e?.parentNode?.closest?.(".disable-patterns")||e?.parentNode?.closest?.("pre")||e?.parentNode?.closest?.("template")||e.matches(".cant-touch-this")||e?.parentNode?.closest?.(".cant-touch-this"))));for(const e of o.reverse())for(const n of t)this.initPattern(n,e,r);document.body.classList.add("patterns-loaded")},register(e,t){if(!(t=t||e.name))return l.error("Pattern lacks a name.",e),!1;if(m.patterns[t])return l.debug(`Already have a pattern called ${t}.`),!1;if(m.patterns[t]=e,e.jquery_plugin){const r=("pat-"+t).replace(/-([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}));o().fn[r]=s.A.jqueryPlugin(e),o().fn[r.replace(/^pat/,"pattern")]=o().fn[r]}return l.debug(`Registered pattern ${t}`,e),window.__patternslib_registry_initialized&&(m.scan(document.body,[t]),l.debug(`Re-scanned dom with newly registered pattern ${t}.`)),!0}},g=m},8633:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(2511),o=r.n(n),i=r(2800);o().fn.safeClone=function(){return this.clone()},Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var r,n;if(null===this)throw new TypeError(" this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(r=t),n=0;n<i;){var a;n in o&&(a=o[n],e.call(r,a,n,o)),n++}});var a=function(e,t,r){return this.each((function(){var n,i=o()(this);if(n=e.init(i,r),t){if(void 0===n[t])return o().error("Method "+t+" does not exist on jQuery."+e.name),!1;if("_"===t.charAt(0))return o().error("Method "+t+" is private on jQuery."+e.name),!1;n[t].apply(n,[r])}})),this},s=function(e,t,r){var n=this;if(t){if(e[t])return e[t].apply(n,[n].concat([r]));o().error("Method "+t+" does not exist on jQuery."+e.name)}else e.init.apply(n,[n].concat([r]));return n};function l(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function d(e){let t=e.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&");return t=t.replace(/[*]/g,".*"),t=new RegExp(`^${t}$`),t}function u(e,t=!1,r=0){e instanceof o()&&(e=e[0]);const n=e.getBoundingClientRect();return![n.top,n.bottom,n.left,n.right].every((e=>0===e))&&(t?n.top<=0+r&&n.bottom>=0+r:n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth))}var c={jqueryPlugin:function(e){return function(t,r){return 0===this.length?this:("object"==typeof t&&(r=t,t=void 0),"function"==typeof e?a.call(this,e,t,r):s.call(this,e,t,r))}},escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isObject:l,extend:function(e){if(!l(e))return e;for(var t,r,n=1,o=arguments.length;n<o;n++)for(r in t=arguments[n])hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},findLabel:function(e){for(var t,r=e.parentNode;r&&11!==r.nodeType;r=r.parentNode)if("LABEL"===r.tagName)return r;return e.id&&(t=o()('label[for="'+e.id+'"]')),t&&0===t.length&&e.form&&(t=o()('label[for="'+e.name+'"]',e.form)),t&&t.length?t[0]:null},regexp_from_wildcard:d,removeWildcardClass:function(e,t){if(e=c.ensureArray(e),-1===t.indexOf("*"))for(const r of e)r.classList.remove(t);else{const r=d(t);for(const t of e){const e=(t.getAttribute("class")||"").split(/\s+/);if(!e.length)continue;const n=e.filter((e=>!r.test(e)));n.length?t.setAttribute("class",n.join(" ")):t.removeAttribute("class")}}},hideOrShow:(e,t,r,n)=>{e=i.A.toNodeArray(e);const a={none:{hide:"hide",show:"show"},fade:{hide:"fadeOut",show:"fadeIn"},slide:{hide:"slideUp",show:"slideDown"}},s="css"===r.transition||"none"===r.transition?null:r.effect.duration,l=e=>{e.classList.remove("in-progress"),e.classList.add(t?"visible":"hidden"),o()(e).trigger("pat-update",{pattern:n,action:"attribute-changed",dom:e,transition:"complete"})};for(const d of e)if(d.classList.remove("visible"),d.classList.remove("hidden"),d.classList.remove("in-progress"),s){const e=a[r.transition];d.classList.add("in-progress"),o()(d).trigger("pat-update",{pattern:n,action:"attribute-changed",dom:d,transition:"start"}),o()(d)[t?e.show:e.hide]({duration:s,easing:r.effect.easing,complete:()=>l(d)})}else"css"!==r.transition&&i.A[t?"show":"hide"](d),l(d)},addURLQueryParameter:function(e,t,r){var n=new RegExp("(\\?|\\&)"+t+"=.*?(?=(&|$))"),o=e.toString().split("#"),i=o[0],a=o[1],s=i;return s=n.test(i)?i.replace(n,"$1"+t+"="+r):/\?.+$/.test(i)?i+"&"+t+"="+r:i+"?"+t+"="+r,a&&(s+="#"+a),s},removeDuplicateObjects:function(e){const t=function(e,t){return this[e]===t};return e.reduce((function(e,r){let n=!1;for(const o of e)n=Object.keys(o).length===Object.keys(r).length&&0===Object.entries(o).filter((e=>!t.bind(r)(e[0],e[1]))).length;return n||e.push(r),e}),[])},mergeStack:function(e,t){const r=[];for(let e=0;e<t;e++)r.push({});for(const n of e){const e=n.length-1;for(let i=0;i<t;i++)r[i]=o().extend(r[i]||{},n[i>e?e:i])}return r},isElementInViewport:u,hasValue:function(e){return"INPUT"===e.tagName?"checkbox"===e.type||"radio"===e.type?e.checked:""!==e.value:"SELECT"===e.tagName?-1!==e.selectedIndex:"TEXTAREA"===e.tagName&&""!==e.value},parseTime:function(e){var t=/^(\d+(?:\.\d+)?)\s*(\w*)/.exec(e);if(!t)throw new Error("Invalid time");var r=parseFloat(t[1]);switch(t[2]){case"s":return Math.round(1e3*r);case"m":return Math.round(1e3*r*60);default:return Math.round(r)}},parseLength:function(e,t=null){const r=/^(\d+(?:\.\d+)?)\s*(\%?\w*)/.exec(e);if(!r)throw new Error("Invalid length");const n=parseFloat(r[1]);switch(r[2]){case"px":default:return Math.round(n);case"%":return t?t/100*Math.round(n):0;case"vw":return Math.round(n*window.innerWidth/100);case"vh":return Math.round(n*window.innerHeight/100);case"vmin":return Math.round(n*Math.min(window.innerWidth,window.innerHeight)/100);case"vmax":return Math.round(n*Math.max(window.innerWidth,window.innerHeight)/100)}},findRelatives:function(e){var t=o()(e),r=o()(e),n=o()();if(r=(r=r.add(t.closest("label"))).add(t.closest("fieldset")),e.id&&(n=o()("label[for='"+e.id+"']")),!n.length){var i=t.closest("form");i.length||(i=o()(document.body)),n=i.find("label[for='"+e.name+"']")}return r=r.add(n)},get_bounds:function(e){const t=e.getBoundingClientRect();return{x:parseInt(Math.round(t.x),10)||0,y:parseInt(Math.round(t.y),10)||0,top:parseInt(Math.round(t.top),10)||0,bottom:parseInt(Math.round(t.bottom),10)||0,left:parseInt(Math.round(t.left),10)||0,right:parseInt(Math.round(t.right),10)||0,width:parseInt(Math.round(t.width),10)||0,height:parseInt(Math.round(t.height),10)||0}},checkInputSupport:function(e,t){let r=!1;const n=document.createElement("input");return n.setAttribute("type",e),r=n.type==e,void 0!==t&&(n.setAttribute("value",t),r=n.value!==t),r},checkCSSFeature:(e,t,r="div")=>{let n=void 0!==(r=document.createElement(r)).style[e];return n&&void 0!==t&&(r.style[e]=t,n=r.style[e]===t),n},animation_frame:()=>new Promise(window.requestAnimationFrame),timeout:e=>new Promise((t=>setTimeout(t,e))),debounce:(e,t,r={timer:null},n=!0)=>(r.last_run=0,function(){const o=arguments;!n&&r.timer&&Date.now()-r.last_run<=t||(clearTimeout(r.timer),r.last_run=Date.now(),r.timer=setTimeout((()=>{e.apply(this,o)}),t))}),isIE:()=>!!document.documentMode,jqToNode:e=>(e.jquery&&(e=e[0]),e),ensureArray:(e,t)=>!!(NodeList.prototype.isPrototypeOf(e)||Array.isArray(e)||e.jquery)?t?[...e]:e:[e],localized_isodate:e=>{const t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getFullYear().toString()}-${r}-${t}`},escape_html:e=>{if(!e)return"";const t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/"/g,"&quot;")},unescape_html:e=>{if(!e)return"";return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent.replace(/&quot;/g,'"')},is_iso_date_time:(e,t=!1)=>(t?/^\d{4}-[01]\d-[0-3]\d(T[0-2]\d:[0-5]\d)?$/:/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d$/).test(e),is_iso_date:e=>/^\d{4}-[01]\d-[0-3]\d$/.test(e),date_diff:(e,t)=>{const r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((r-n)/864e5)},threshold_list:(e=0)=>{let t=[];for(let r=1;r<=e;r++)t.push(r/e);return t.push(0),t.sort()},is_option_truthy:e=>![void 0,null,"none",!1,"false",""].includes(e),elementInViewport:e=>(console.warn("Deprecated. Use utils.isElementInViewport"),u(e))};const p=c}}]);
//# sourceMappingURL=27.4f9fc39769cc83586f25.min.js.map